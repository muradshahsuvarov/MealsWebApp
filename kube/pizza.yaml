apiVersion: v1
kind: Service
metadata:
  name: pizza-app-service
spec:
  selector:
    app: pizza-app
  ports:
    - port: 80 # Public Port. Kubernetes Service takes requests from port 80 and forward them to the internal port 5000
      targetPort: 5000 # In this case, the Service listens for requests on port 80 and forwards them to port 3000 of the target Pods:
  type: LoadBalancer # In this case, the type is LoadBalancer, which makes the exposed Pods accessible from outside the cluster. Picks an appropriate pod to forware an incoming request to. The default Service type is ClusterIP, which makes the exposed Pods only accessible from within the cluster.
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: pizza-app-deployment
spec: # Specifications for the Deployment Resource (Pod Manager)
  replicas: 1 # It's desired to keep 1 pod running, and healthy
  selector: # Run those pods whose label is pizza-app
    matchLabels:
      app: pizza-app
  template: # Specifications of the POD (Containers running in it). This field defines a label for the Pods that wrap your container
    metadata:
      labels:
        app: pizza-app # Gives name to the pod
    spec:
      containers:
        - name: pizzaapp-back-end
          image: 4141472/pizzaapp-back-end:latest
          ports:
            - containerPort: 5000
          imagePullPolicy: Always # Forces the Docker image to be downloaded, even if it was already downloaded.